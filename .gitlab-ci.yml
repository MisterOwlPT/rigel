image:
  name: docker:git

services:
  - docker:18.09.7-dind

stages:
  - release

release_job:
  stage: release
  only:
    - tags
  script:
    - apk update && apk add --no-cache build-base gcc python3 python3-dev py3-pip
    - pip3 install twine wheel
    - rm -rf build dist *.egg-info
    - python3 setup.py sdist bdist_wheel
    - python3 -m twine upload dist/*
